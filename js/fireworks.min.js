var Fireworks=function(){function a(){b();createjs.Sound.play("Shot",{volume:.3})}function g(a){var d=10*a;l.width=d;l.height=d;h.globalCompositeOperation="source-over";for(var n=0;100>n;n++){var b=n*a,c=b%d,b=Math.floor(b/d)*a;h.fillStyle="hsl("+Math.round(3.6*n)+",100%,60%)";h.fillRect(c,b,a,a);h.drawImage(Library.bigGlow,c,b)}}function f(){c.fillStyle="rgba(0,0,0,0.2)";c.fillRect(0,0,p,q);e();requestAnimFrame(f);for(var a=k.length;a--;){var d=k[a];d.update()&&(k.splice(a,1),d.usePhysics||(.8>Math.random()?
FireworkExplosions.star(d):FireworkExplosions.circle(d),createjs.Sound.play("Fire",{volume:1})));d.render(c,l)}}function e(){var a=document.getElementById("moon"),d=canvas.width-500;a.complete?c.drawImage(a,d,100,60,60):a.onload=function(){c.drawImage(a,d,100,60,60)};for(var b=0,e=0;10>e;e++)c.save(),c.beginPath(),c.arc(d+30,130,30+b,0,2*Math.PI),c.fillStyle="rgba(240,219,120,0.008)",b+=2,c.fill(),c.restore()}function b(a,d,b,c,e){a=a||{};d=d||{};b=b||{};k.push(new Particle({x:a.x||.5*p,y:a.y||q+
10},{y:d.y||150+100*Math.random()},{x:b.x||3*Math.random()-1.5,y:b.y||0},c||12*Math.floor(100*Math.random()),e))}var k=[],m=null,c=null,l=null,h=null,p=0,q=0;return{initialize:function(){p=window.innerWidth;q=window.innerHeight;m=document.createElement("canvas");m.id="fireWork";c=m.getContext("2d");l=document.createElement("canvas");h=l.getContext("2d");g(12);m.width=p;m.height=q;document.getElementById("container").appendChild(m);document.addEventListener("mouseup",a,!0);document.addEventListener("touchend",
a,!0);document.addEventListener("click",a,!0);var b=function(){var a,b,c={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(a in c)if(a in document){b=c[a];break}return function(c){c&&document.addEventListener(b,c);return!document[a]}}();"complete"===document.readyState&&setInterval(function(){b()&&a()},5E3);createjs.Sound.alternateExtensions=["ogg"];createjs.Sound.registerSound("sound/fx/shot3.mp3","Shot");createjs.Sound.registerSound("sound/fx/fire1.mp3",
"Fire");f()},createParticle:b}}(),Particle=function(a,g,f,e,b){this.GRAVITY=.06;this.alpha=1;this.easing=.02*Math.random();this.fade=.1*Math.random();this.gridX=e%120;this.gridY=12*Math.floor(e/120);this.color=e;this.pos={x:a.x||0,y:a.y||0};this.vel={x:f.x||0,y:f.y||0};this.lastPos={x:this.pos.x,y:this.pos.y};this.target={y:g.y||0};this.usePhysics=b||!1};
Particle.prototype={update:function(){this.lastPos.x=this.pos.x;this.lastPos.y=this.pos.y;if(this.usePhysics)this.vel.y+=this.GRAVITY,this.pos.y+=this.vel.y,this.alpha-=this.fade;else{var a=this.target.y-this.pos.y;this.pos.y+=a*(.03+this.easing);this.alpha=Math.min(a*a*5E-5,1)}this.pos.x+=this.vel.x;return.005>this.alpha},render:function(a,g){var f=Math.round(this.pos.x),e=Math.round(this.pos.y),b=-5*(f-this.lastPos.x),k=-5*(e-this.lastPos.y);a.save();a.globalCompositeOperation="lighter";a.globalAlpha=
Math.random()*this.alpha;a.fillStyle="rgba(255,255,255,0.3)";a.beginPath();a.moveTo(this.pos.x,this.pos.y);a.lineTo(this.pos.x+1.5,this.pos.y);a.lineTo(this.pos.x+b,this.pos.y+k);a.lineTo(this.pos.x-1.5,this.pos.y);a.closePath();a.fill();a.drawImage(g,this.gridX,this.gridY,12,12,f-6,e-6,12,12);a.drawImage(Library.smallGlow,f-3,e-3);a.restore()}};
var Library={bigGlow:document.getElementById("big-glow"),smallGlow:document.getElementById("small-glow")},FireworkExplosions={circle:function(a){for(var g=100,f=2*Math.PI/g;g--;){var e=4+4*Math.random(),b=g*f;Fireworks.createParticle(a.pos,null,{x:Math.cos(b)*e,y:Math.sin(b)*e},a.color,!0)}},star:function(a){var g=6+Math.round(15*Math.random()),f=3+Math.round(7*Math.random()),e=-(3*Math.random()-6),b=0,k=0,m=2*Math.PI,c=Math.random()*m;do for(var b=k,k=(k+f)%g,l=b/g*m-c,h=(b+f)/g*m-c,b=a.pos.x+80*
Math.cos(l),p=a.pos.y+80*Math.sin(l),q=a.pos.x+80*Math.cos(h)-b,t=a.pos.y+80*Math.sin(h)-p,h=h-l,d=0;10>d;d++){var n=d/10,r=l+n*h;Fireworks.createParticle({x:b+n*q,y:p+n*t},null,{x:Math.cos(r)*e,y:Math.sin(r)*e},a.color,!0)}while(0!==k)}};window.onload=function(){Fireworks.initialize()};